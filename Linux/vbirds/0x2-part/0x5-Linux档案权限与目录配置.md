# 第二部分 第五章 Linux的档案权限与目录配置

## 1、使用者与群组

### 档案拥有者

由于Linux是个多人多工的系统，因此可能会有多人同时使用电脑工作的情况发生，为了考虑每个人的隐私权以及每个人喜好的工作环境，这个`档案拥有者`的角色就相当重要了。尤其是在这个具有相当健全而好用的安全防护功能的`使用者群组`的功能下。  

例如：你的隐私，因为你是拥有者，权限设置为只有你才能看到，那么别人哪怕知道你有这个文档，但是因为没有权限，也无法知道这个文档的内容。  

### 群组概念

那麼群組呢？為何要設定檔案還有所屬的群組？其實，群組最有用的功能之一，就是當你在團隊開發資源的時候啦！ 舉例來說，假設有兩組專題生在我的主機裡面，第一個專題組別為projecta，裡面的成員有 class1, class2, class3三個；第二個專題組別為projectb，裡面的成員有class4, class5, class6。 這兩個專題之間是有競爭性質的，但卻要繳交同一份報告。每組的組員之間必須要能夠互相修改對方的資料， 但是其他組的組員則不能看到本組自己的檔案內容，此時該如何是好？

在Linux底下這樣的限制是很簡單啦！我可以經由簡易的檔案權限設定，就能限制非自己團隊(亦即是群組囉) 的其他人不能夠閱覽內容囉！而且亦可以讓自己的團隊成員可以修改我所建立的檔案！ 同時，如果我自己還有私人隱密的文件，仍然可以設定成讓自己的團隊成員也看不到我的檔案資料。 很方便吧！

另外，如果teacher這個帳號是projecta與projectb這兩個專題的老師， 他想要同時觀察兩者的進度，因此需要能夠進入這兩個群組的權限時，你可以設定teacher這個帳號， 『同時支援projecta與projectb這兩個群組！』，也就是說：每個帳號都可以有多個群組的支援呢！

這樣說或許你還不容易理解這個使用者與群組的關係吧？沒關係，我們可以使用目前『家庭』的觀念來進行解說喔！ 假設有一家人，家裡只有三兄弟，分別是王大毛、王二毛與王三毛三個人， 而這個家庭是登記在王大毛的名下的！所以，『王大毛家有三個人，分別是王大毛、王二毛與王三毛』， 而且這三個人都有自己的房間，並且共同擁有一個客廳喔！

- 使用者的意義：由於王家三人各自擁有自己的房間，所以， 王二毛雖然可以進入王三毛的房間，但是二毛不能翻三毛的抽屜喔！那樣會被三毛K的！ 因為抽屜裡面可能有三毛自己私人的東西，例如情書啦，日記啦等等的，這是『私人的空間』，所以當然不能讓二毛拿囉！

- 群組的概念：由於共同擁有客廳，所以王家三兄弟可以在客廳打開電視機啦、 翻閱報紙啦、坐在沙發上面發呆啦等等的！ 反正，只要是在客廳的玩意兒，三兄弟都可以使用喔！ 因為大家都是一家人嘛！

這樣說來應該有點曉得了喔！那個『王大毛家』就是所謂的『群組』囉， 至於三兄弟就是分別為三個『使用者』，而這三個使用者是在同一個群組裡面的喔！ 而三個使用者雖然在同一群組內，但是我們可以設定『權限』， 好讓某些使用者個人的資訊不被群組的擁有者查詢，以保有個人『私人的空間』啦！ 而設定群組共享，則可讓大家共同分享喔！

### 其他人的概念


好了，那麼今天又有個人，叫做張小豬，他是張小豬家的人，與王家沒有關係啦！ 這個時候，除非王家認識張小豬，然後開門讓張小豬進來王家，否則張小豬永遠沒有辦法進入王家， 更不要說進到王三毛的房間啦！不過，如果張小豬透過關係認識了三毛，並且跟王三毛成為好朋友， 那麼張小豬就可以透過三毛進入王家啦！呵呵！沒錯！那個張小豬就是所謂的『其他人，Others』囉！

---

因此，我們就可以知道啦，在Linux裡面，任何一個檔案都具有『User, Group及Others』三種身份的個別權限。  
我們以王三毛為例，王三毛這個『檔案』的擁有者為王三毛，他屬於王大毛這個群組， 而張小豬相對於王三毛，則只是一個『其他人(others)』而已。

不過，這裡有個特殊的人物要來介紹的，那就是『萬能的天神』！這個天神具有無限的神力， 所以他可以到達任何他想要去的地方，呵呵！那個人在Linux系統中的身份代號是『 root 』啦！所以要小心喔！那個root可是『萬能的天神』喔！

無論如何，『使用者身份』，與該使用者所支援的『群組』概念，在Linux的世界裡面是相當的重要的， 他可以幫助你讓你的多工Linux環境變的更容易管理！更詳細的 『身份與群組』 設定，我們將在第十三章、帳號管理再進行解說。 底下我們將針對檔案系統與檔案權限來進行說明。

### Linux使用者身份与群组记录的档案

我们在linux系统档中，预设的情况下，所有的系统上的账号与一般身份使用者，还有那个root的相关资讯，  
都记录在 `/etc/passwd` 这个档案内。  
个人密码记录在 `/etc/shadow` 这个档案下。  
所有群组名称记录在 `/etc/group` 这个档案下。  
这三个档案可以说是Linux系统里面账号、密码、群组资讯的集中第。不要随便删除这三个档案啊！  

---

## 2、Linux档案权限概念

档案权限如何针对这些所谓的**使用者**与**群组**来设定呢？  
这部分相当重要，是学Linux的一个相当重要的关卡，如果没有这部分的概念，你将老师听不懂别人在说什么。  
亦或者是屏幕出现 `Permission deny` 的时候，别担心，肯定是权限设定错误啦。  

### 2.1、Linux档案属性，改变语系的 locale

首先，用普通用户登录（不建议直接登录root），使用 `su -` 切换到root用户（相当于用友root权限），最后可以输入 `exit` 退出root返回到普通用户。  

ls指令：（list：列表的意思），【-alh】a：all（显示隐藏文件，前面带点的）、l：list（详细列表，显示权限、节点、拥有者、群组等等）、h：human（以人类刻度的字节数显示文档大小）  

```
[dmtsai@study ~]$ su -  # 先來切換一下身份看看
Password:
Last login: Tue Jun  2 19:32:31 CST 2015 on tty2
[root@study ~]# ls -al
total 48
dr-xr-x---.  5    root     root    4096  May 29 16:08 .
dr-xr-xr-x. 17    root     root    4096  May  4 17:56 ..
-rw-------.  1    root     root    1816  May  4 17:57 anaconda-ks.cfg
-rw-------.  1    root     root     927  Jun  2 11:27 .bash_history
-rw-r--r--.  1    root     root      18  Dec 29  2013 .bash_logout
-rw-r--r--.  1    root     root     176  Dec 29  2013 .bash_profile
-rw-r--r--.  1    root     root     176  Dec 29  2013 .bashrc
drwxr-xr-x.  3    root     root      17  May  6 00:14 .config               <=範例說明處
drwx------.  3    root     root      24  May  4 17:59 .dbus
-rw-r--r--.  1    root     root    1864  May  4 18:01 initial-setup-ks.cfg  <=範例說明處
[    1    ][  2 ][   3  ][  4 ][    5   ][    6     ] [       7          ]
[  權限   ][連結][擁有者][群組][檔案容量][ 修改日期 ] [      檔名        ]
```

---

#### 1 —— 这个档案的类型与权限

一共10个字符：（例如：`-rwxr--r--`）

- 第一个字符代表这个档案类型
	- 【d】：目录
	- 【-】：文档（档案）
	- 【l】：链接档/连接档（link file）
	- 【b】：装置当里面的可供存储的周边设备（可随机读取装置）；
	- 【c】：装置档案里面的序列埠设备，例如鼠标、键盘（一次性读取装置）

- 接下来的字符，三个一组，且均为 `rwx` 三个参数的组合。
	- 【r】：可读（read）
	- 【w】：可写（write）
	- 【x】：可执行（execute）
	- 要注意：这三个权限的位置不会改变，如果没有权限，就会出现`-`而已。
	- -------
	- 第一组：档案拥有者可具备的权限
	- 第二组：加入此群组之账号的权限
	- 第三组：非本人且没加入本群组之其他账号的权限


#### 2 -- 有多少个档名连接到此节点（i-node）：

每个档案都会将它的权限与属性记录到档案系统的i-node中，不过，我们使用的目录树却是使用档名来记录，因此每个档名就会连接到一个i-node喽！  
这个属性记录的，就是有多少不同的档名连接到相同的一个i-node号码去就是了。

#### 3 -- 这个档案（或目录）的【拥有者账号】

#### 4 -- 这个档案的所属群组

在linux系统下，一个账号会加入于一个或多个的群组。

#### 5 -- 这个档案的容量大小，预设单位为bytes

这里用ls的时候，可以使用-h指令，以人类客户的形式展示出来，（就是会显示G、M、K、B等等单位）  

#### 6 -- 这个档案的建档日期或者是最近的修改日期

这一栏的内容分别为日期（月/日）及时间。如果这个档案被修改的时间距离现在太久了，那么时间部分会仅显示年份而已。  
如果想要显示完整的时间格式，可以利用ls的选项：`ls -l --full-time`  
另外如果安装的Linux是中文版，那么日期栏会以中文显示出来。  
如果中文没办法在纯文字的终端机模式中正确的显示，就会变成乱码。  
那就要使用 `export LC_ALL=en_US.utf8`来修改语系。  

**如果想要让系统预设的语系变成英文的话，那么可以修改系统设定档`/etc/locale.conf`**

#### 7 -- 这个档案的名称

这个就是档名了，如果前面多一个【.】，则代表这个档是【隐藏档】  
可以使用：`ls -a` 来显示隐藏档。  

----

#### Linux档案权限的重要性

相比windows，Linux系统的每个档案都多家了多个属性进来，尤其是群组的概念，其最大的用途是在【资料安全性】上面。  

- 系统保护的功能：
	- 例如：在系统中，关于系统服务的档案通常中油root才能读写或执行，例如`/etc/shadow`权限是【----------】，所有人都不能用？没关系，root基本上是不瘦系统的权限所限制的，无论文档权限为何，预设 root 都可以存取。  

- 团队开发软件或资料共同的功能
	- 例如有一个开发团队，一个文档只允许此团队读写执行，权限可设置为【-rwxrwx---】，然后把该团队加入到该组中。  

- 未将权限设定妥当的危害：
	- 例如只有root可以做的开关机，改成任何人都可以执行的话，就非常危险了。

可怕吧！因此，在修改Linux档案与目录的属性之前，一定要先搞情况，什么资料是可变的，什么是不可变的！千万要注意！

### 2.2、如何改变档案属性与权限：chgrp、chown、chmod


### 2.3、目录与档案之权限意义：，资料夹与抽屉，各种动作所需最小权限


### 2.4、Linux档案种类与副档名



---

## 3、Linux目录配置

### 3.1、Linux目录配置的依据--FHS：/,/usr,/var

### 3.2、目录树(directory tree)

### 3.3、绝对路径与相对路径


### 3.4、CentOS的观察：lsb_release





----

## 4、重点回顾














